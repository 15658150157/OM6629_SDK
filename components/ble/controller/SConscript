from build.building import *

BLE_CONTROLLER_SRCS = []
BLE_CONTROLLER_INCS = ['include']
BLE_CONTROLLER_DEFS = []
BLE_CONTROLLER_LIBS = []

# Append defines
if GetDepend('CONFIG_BLE_CONTROLLER_LIB_1PERIPHERAL'):
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_BROADCASTER=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_PERIPHERAL=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_ACTIVITY_NB=2']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_CONNECTION_NB=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_WHITELIST_NB=6']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_HCI_CMD_PKTS_NB=2']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_RX_DATA_BUF_NB=3']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_RX_DATA_BUF_SIZE=256']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ACL_BUF_NB=3']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ACL_BUF_SIZE=256']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ADV_BUF_NB=2']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ADV_FRAG_NB=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ADV_FRAG_BUF_SIZE=37']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_LLCP_BUF_NB=3']

elif GetDepend('CONFIG_BLE_CONTROLLER_LIB_FULL'):
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_BROADCASTER=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_OBSERVER=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_PERIPHERAL=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_CENTRAL=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_ACTIVITY_NB=10']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_CONNECTION_NB=8']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_WHITELIST_NB=6']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_HCI_CMD_PKTS_NB=2']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_RX_DATA_BUF_NB=3']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_RX_DATA_BUF_SIZE=256']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ACL_BUF_NB=3']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ACL_BUF_SIZE=256']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ADV_BUF_NB=5']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ADV_FRAG_NB=2']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ADV_FRAG_BUF_SIZE=254']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_LLCP_BUF_NB=11']

elif GetDepend('CONFIG_BLE_CONTROLLER_LIB_VELA_MESH'):
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_BROADCASTER=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_OBSERVER=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_PERIPHERAL=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_CENTRAL=1']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_ACTIVITY_NB=8']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_CONNECTION_NB=2']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_WHITELIST_NB=6']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_HCI_CMD_PKTS_NB=2']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_RX_DATA_BUF_NB=3']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_RX_DATA_BUF_SIZE=256']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ACL_BUF_NB=3']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ACL_BUF_SIZE=256']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ADV_BUF_NB=6']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ADV_FRAG_NB=2']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_ADV_FRAG_BUF_SIZE=254']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_TX_LLCP_BUF_NB=5']
    BLE_CONTROLLER_DEFS += ['CONFIG_LE_LL_SEC_CON=1']

# Append library
if GetDepend('CONFIG_TOOL_CHAIN_GCC'):
    if GetDepend('CONFIG_BLE_CONTROLLER_LIB_1PERIPHERAL'):
        BLE_CONTROLLER_LIBS += ['lib/GCC/libblectlr_1peripheral.a']
    elif GetDepend('CONFIG_BLE_CONTROLLER_LIB_FULL'):
        BLE_CONTROLLER_LIBS += ['lib/GCC/libblectlr_full.a']
    elif GetDepend('CONFIG_BLE_CONTROLLER_LIB_VELA_MESH'):
        BLE_CONTROLLER_LIBS += ['lib/GCC/libblectlr_vela_mesh.a']
elif GetDepend('CONFIG_TOOL_CHAIN_ARMCLANG'):
    if GetDepend('CONFIG_BLE_CONTROLLER_LIB_1PERIPHERAL'):
        BLE_CONTROLLER_LIBS += ['lib/ARM/libblectlr_1peripheral.lib']
    elif GetDepend('CONFIG_BLE_CONTROLLER_LIB_FULL'):
        BLE_CONTROLLER_LIBS += ['lib/ARM/libblectlr_full.lib']
    elif GetDepend('CONFIG_BLE_CONTROLLER_LIB_VELA_MESH'):
        BLE_CONTROLLER_LIBS += ['lib/ARM/libblectlr_vela_mesh.lib']
elif GetDepend('CONFIG_TOOL_CHAIN_ICCARM'):
    if GetDepend('CONFIG_BLE_CONTROLLER_LIB_1PERIPHERAL'):
        BLE_CONTROLLER_LIBS += ['lib/IAR/libblectlr_1peripheral.a']
    elif GetDepend('CONFIG_BLE_CONTROLLER_LIB_FULL'):
        BLE_CONTROLLER_LIBS += ['lib/IAR/libblectlr_full.a']
    elif GetDepend('CONFIG_BLE_CONTROLLER_LIB_VELA_MESH'):
        BLE_CONTROLLER_LIBS += ['lib/IAR/libblectlr_vela_mesh.a']
else:
    raise Exception('Toolchain is not configured or SDK donot support the compiler')


group = DefineGroup(name='controller', srcs=BLE_CONTROLLER_SRCS, incs=BLE_CONTROLLER_INCS, libs=BLE_CONTROLLER_LIBS, CPPDEFINES=BLE_CONTROLLER_DEFS)

Return('group')