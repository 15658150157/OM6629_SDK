<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="Doxygen Awesome" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>User Guide: Power Manage</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom-alternative.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/
<a href="https://github.com/jothepro/doxygen-awesome-css" class="github-corner" title="View source on GitHub" target="_blank">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
-->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">User Guide
   </div>
   <div id="projectbrief">Bluetooth Low Energy 5.4</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('POWER_MANAGE.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Power Manage </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_doxygen_source_user_guides_power_manage"></a></p>
<h1><a class="anchor" id="autotoc_md69"></a>
Power Mode</h1>
<p>The chip has 5 power modes: active mode, idle mode, sleep mode, deep sleep mode, ultra deep sleep mode</p>
<ul>
<li>In the active mode and idle mode, the clock of digital modules (Timer, UART, SPI, PWM ...) can be enabled or disabled independently. The power of analog modules which have independent power domain can also be enabled or disabled by application.</li>
<li>In the idle mode, the clock of processor is gated and all of the interrupts can wakeup system.</li>
<li>In the sleep mode, the interrupts of GPIO, PMU_TIMER and BLE can wakeup the system.</li>
<li>In the deep sleep mode, the interrupts of GPIO can wakeup system. And if 32k is running, RTC also can wakeup system. BLE stack does not work in the deep sleep mode.</li>
<li>In ultra deep sleep mode, wakeup source is similar to deep sleep. It also power off all SRAM, the wakeup will trigger system reboot. Use function <a class="el" href="group__PM.html#ga3a9ac8f95cc515b08db680dcf5e2cf6e">pm_sleep_ultra_sleep_mode_enable()</a> to enable it.</li>
</ul>
<p>The following table shows the difference between the 5 modes:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Mode   </th><th class="markdownTableHeadNone">CPU Clock   </th><th class="markdownTableHeadNone">CPU Power   </th><th class="markdownTableHeadNone">Wakeup Source   </th><th class="markdownTableHeadNone">Have Power Modules    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Active   </td><td class="markdownTableBodyNone">ON   </td><td class="markdownTableBodyNone">ON   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone">All Modules (** )    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Idle   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">ON   </td><td class="markdownTableBodyNone">All Interrupts   </td><td class="markdownTableBodyNone">All Modules (** )    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Sleep   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">GPIO, PMU_TIMER, LPTimer, RTC   </td><td class="markdownTableBodyNone">SRAM, GPIO, 32K, PMU_TIMER, LPTimer(option), BLE(option), RTC(option)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Deep Sleep   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">GPIO, RTC   </td><td class="markdownTableBodyNone">SRAM, GPIO, 32K(option), RTC(option)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Ultra Deep Sleep   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">OFF   </td><td class="markdownTableBodyNone">GPIO, RTC   </td><td class="markdownTableBodyNone">GPIO, 32K(option), RTC(option)   </td></tr>
</table>
<p><em>(** ) The power and clock of periphals which are not used can be closed.</em></p>
<p>The following table shows how to enter the different power modes:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Mode   </th><th class="markdownTableHeadNone">How    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Active   </td><td class="markdownTableBodyNone">CPU handles something (event of <a class="el" href="group__EVT.html#ga8b3b37b758d883c4e2152ff405bf8675">evt_set()</a>, the RF of BLE is configuring, handle IRQ, ...)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Idle   </td><td class="markdownTableBodyNone">Use API <a class="el" href="group__PM.html#gaae0a5bf0f02a1932a9c7e67d1dd4c890">pm_sleep_prevent()</a> to prevent sleep (some drivers have been called).<br  />
 (or) IO is in wakeup state (reference <a class="el" href="group__PMU.html#gad84c9f7ce29d9c818d952c07a99c0d31">drv_pmu_wakeup_pin_set</a>).<br  />
 (or) The RF of BLE is running.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Sleep   </td><td class="markdownTableBodyNone">There are no <a class="el" href="group__PM.html#gaae0a5bf0f02a1932a9c7e67d1dd4c890">pm_sleep_prevent()</a>. <br  />
 (and) IO is not in wakeup state.<br  />
 (and) The RF of BLE is not running.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Deep Sleep   </td><td class="markdownTableBodyNone">The conditions of sleep mode are met.<br  />
 (and) There is no BLE (no adv/connection/scan) running.<br  />
 (and) There is no 32k timer (evt_timer, WDT...) running.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Ultra Deep Sleep   </td><td class="markdownTableBodyNone">The conditions of deep sleep mode are met.<br  />
 (and) function <a class="el" href="group__PM.html#ga3a9ac8f95cc515b08db680dcf5e2cf6e">pm_sleep_ultra_sleep_mode_enable()</a> is enabled.   </td></tr>
</table>
<p><em>(or) is logical OR. (and) is logical AND.</em></p>
<p>The following table shows the minimum requested power mode for each modules:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Modules   </th><th class="markdownTableHeadNone">Minimum Requested Power Mode    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GPDMA   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">GPADC   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">CPM   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">I2C   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">I2S   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SPI   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Timer   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">UART   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">AES   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Audio   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">IRTX   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">QSPI   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">QDEC   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RGB   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TRNG   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SHA256   </td><td class="markdownTableBodyNone">Idle    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Flash   </td><td class="markdownTableBodyNone">Idle (**)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2.4G   </td><td class="markdownTableBodyNone">Idle (**)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pinmux   </td><td class="markdownTableBodyNone">Idle (**)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">WDT   </td><td class="markdownTableBodyNone">Sleep    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">BLE   </td><td class="markdownTableBodyNone">Sleep    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RTC   </td><td class="markdownTableBodyNone">Sleep    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PMU_Timer   </td><td class="markdownTableBodyNone">Sleep    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">LPTimer   </td><td class="markdownTableBodyNone">Sleep    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GPIO (***)   </td><td class="markdownTableBodyNone">Idle (**)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">GPIO(in PMU)   </td><td class="markdownTableBodyNone">Deep Sleep    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">PMU   </td><td class="markdownTableBodyNone">Deep Sleep   </td></tr>
</table>
<p><em> (**) HW restore its regisers automatically after wakeup.<br  />
 (***) The GPIO module consists of two parts, one part located in the PMU module, the other part does not belong to PMU and it does not working in sleep mode. </em></p>
<h1><a class="anchor" id="autotoc_md70"></a>
Power Control</h1>
<p>Power mode control depends on user setting, peripherals’ status and BLE’s status.</p>
<ul>
<li>The user power mode setting is managed by user who can use API <a class="el" href="group__PM.html#gaae0a5bf0f02a1932a9c7e67d1dd4c890">pm_sleep_prevent()</a> / <a class="el" href="group__PM.html#ga3de7dba19bee189c19e82e5cc0dcc603">pm_sleep_allow()</a> to allow or prevent sleep.</li>
<li>Before sleep, the sleep status is checked. That can use API <a class="el" href="group__PM.html#gaec024639daf77b28278ef0a8d61b99ef">pm_sleep_checker_callback_register()</a> to customized, and 1st checking callback is <a class="el" href="group__PMU.html#ga9f08c9bf1116ce3278b1c783d9265714">drv_pmu_deep_sleep_is_allow()</a>.</li>
<li>The most of the peripherals’ status is managed by drivers. Actually the driver knows when the peripherals cannot enter into sleep mode. For example when the ADC is sampling, the ADC driver knows the system cannot enter into sleep mode at this time. User does not take care of the peripherals’ status.</li>
<li>Some peripherals require user to manage. For example, when UART receive data, the driver does not know when the long packet is recived. So user should tell system the information.</li>
<li>The status of BLE is managed by BLE stack.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>When the system is waked up from sleep mode, all register setting of some peripherals are lost and the peripherals need to be reconfigured. Those reconfigured peripherals include: <b>GPIO, Timer, UART, SPI, DMA, ADC, I2C, ...</b>.</dd></dl>
<h1><a class="anchor" id="autotoc_md71"></a>
System Scheduler and Power Manager Flow</h1>
<p>The system scheduler and power manager are included in <a class="el" href="group__EVT.html#ga5e9d76dd6b10db3022d38f057193fe36" title="Event scheduler entry point.">evt_schedule()</a> which reference <a class="el" href="OPERATING_SYSTEM.html">Operating System</a>. The flow is shown as follow:</p>
<div class="plantumlgraph">
<img src="inline_umlgraph_1.png" />
<div class="caption">
System Scheduler and Power Manager Flow</div>
</div>
<dl class="section note"><dt>Note</dt><dd>When system come into SLEEP mode, the CPU is powered down. So the debug interface (SWD) will be disconnected and KEIL losts connection. The function <a class="el" href="group__PM.html#ga9de92c7182c5638b6fcc51ac520d004c">pm_sleep_enable()</a> can disable SLEEP mode for better debugging.</dd></dl>
<h2><a class="anchor" id="autotoc_md72"></a>
Reference Code</h2>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> pm_sleep_notify_handler(<a class="code hl_enumeration" href="group__PM.html#ga04e99c9c373636bd60b59f3f98d330ee">pm_sleep_state_t</a> sleep_state, <a class="code hl_enumeration" href="group__PM.html#gac4d27cf0310d8173f6f5d1e71ddb0abc">pm_status_t</a> power_status)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">switch</span>(sleep_state)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__PM.html#gga04e99c9c373636bd60b59f3f98d330eeacdb7fa2fb33997b7021e9d00faf5f593">PM_SLEEP_ENTRY</a>:</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__PM.html#gga04e99c9c373636bd60b59f3f98d330eea7de28df7d63b1edd5c93b525481fad20">PM_SLEEP_LEAVE_TOP_HALF</a>:</div>
<div class="line">            <span class="comment">// restore UART</span></div>
<div class="line">            <span class="comment">//drv_usart_init(HCI_UART, &amp;hci_usart_cfg);</span></div>
<div class="line">            <span class="comment">//drv_usart_read_int(HCI_UART, NULL, 0);</span></div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__PM.html#gga04e99c9c373636bd60b59f3f98d330eea61fe0a33296678101a2951e620352597">PM_SLEEP_LEAVE_BOTTOM_HALF</a>:</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> hardware_init(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    ......</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="group__PM.html#ga7552fcc5d722c306d82b0ab62508571c">pm_sleep_notify_user_callback_register</a>(pm_sleep_notify_handler);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="group__BLE__APP__SIMPLE.html#ga840291bc02cba5474a4cb46a9b9566fe">main</a>(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    hardware_init();</div>
<div class="line"> </div>
<div class="line">    ......</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Main loop</span></div>
<div class="line">    <span class="keywordflow">while</span>(1) {</div>
<div class="line">        <span class="comment">// do event schedule</span></div>
<div class="line">        <a class="code hl_function" href="group__EVT.html#ga5e9d76dd6b10db3022d38f057193fe36">evt_schedule</a>();</div>
<div class="line"> </div>
<div class="line">        OM_CRITICAL_BEGIN();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// if no event, do power manage</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_function" href="group__EVT.html#ga17b20b414c5f1de2f23b87ea0bf5c53f">evt_get_all</a>() == 0) {</div>
<div class="line">            <a class="code hl_function" href="group__PM.html#gaca065483cfe789215a4d194eda3fc931">pm_power_manage</a>();</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        OM_CRITICAL_END();</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__BLE__APP__SIMPLE_html_ga840291bc02cba5474a4cb46a9b9566fe"><div class="ttname"><a href="group__BLE__APP__SIMPLE.html#ga840291bc02cba5474a4cb46a9b9566fe">main</a></div><div class="ttdeci">int main(void)</div><div class="ttdoc">main entry of program</div><div class="ttdef"><b>Definition:</b> ble_app_simple.c:142</div></div>
<div class="ttc" id="agroup__EVT_html_ga17b20b414c5f1de2f23b87ea0bf5c53f"><div class="ttname"><a href="group__EVT.html#ga17b20b414c5f1de2f23b87ea0bf5c53f">evt_get_all</a></div><div class="ttdeci">uint32_t evt_get_all(void)</div><div class="ttdoc">Get all event status.</div></div>
<div class="ttc" id="agroup__EVT_html_ga5e9d76dd6b10db3022d38f057193fe36"><div class="ttname"><a href="group__EVT.html#ga5e9d76dd6b10db3022d38f057193fe36">evt_schedule</a></div><div class="ttdeci">void evt_schedule(void)</div><div class="ttdoc">Event scheduler entry point.</div></div>
<div class="ttc" id="agroup__PM_html_ga04e99c9c373636bd60b59f3f98d330ee"><div class="ttname"><a href="group__PM.html#ga04e99c9c373636bd60b59f3f98d330ee">pm_sleep_state_t</a></div><div class="ttdeci">pm_sleep_state_t</div><div class="ttdoc">Sleep state.</div><div class="ttdef"><b>Definition:</b> pm.h:78</div></div>
<div class="ttc" id="agroup__PM_html_ga7552fcc5d722c306d82b0ab62508571c"><div class="ttname"><a href="group__PM.html#ga7552fcc5d722c306d82b0ab62508571c">pm_sleep_notify_user_callback_register</a></div><div class="ttdeci">void pm_sleep_notify_user_callback_register(pm_sleep_callback_t notify_cb)</div><div class="ttdoc">system sleep notify user callback register</div></div>
<div class="ttc" id="agroup__PM_html_gac4d27cf0310d8173f6f5d1e71ddb0abc"><div class="ttname"><a href="group__PM.html#gac4d27cf0310d8173f6f5d1e71ddb0abc">pm_status_t</a></div><div class="ttdeci">pm_status_t</div><div class="ttdoc">PM status.</div><div class="ttdef"><b>Definition:</b> pm.h:64</div></div>
<div class="ttc" id="agroup__PM_html_gaca065483cfe789215a4d194eda3fc931"><div class="ttname"><a href="group__PM.html#gaca065483cfe789215a4d194eda3fc931">pm_power_manage</a></div><div class="ttdeci">void pm_power_manage(void)</div><div class="ttdoc">pm power manage, it shall be called in critical section(disable global interrupt)</div></div>
<div class="ttc" id="agroup__PM_html_gga04e99c9c373636bd60b59f3f98d330eea61fe0a33296678101a2951e620352597"><div class="ttname"><a href="group__PM.html#gga04e99c9c373636bd60b59f3f98d330eea61fe0a33296678101a2951e620352597">PM_SLEEP_LEAVE_BOTTOM_HALF</a></div><div class="ttdeci">@ PM_SLEEP_LEAVE_BOTTOM_HALF</div><div class="ttdef"><b>Definition:</b> pm.h:90</div></div>
<div class="ttc" id="agroup__PM_html_gga04e99c9c373636bd60b59f3f98d330eea7de28df7d63b1edd5c93b525481fad20"><div class="ttname"><a href="group__PM.html#gga04e99c9c373636bd60b59f3f98d330eea7de28df7d63b1edd5c93b525481fad20">PM_SLEEP_LEAVE_TOP_HALF</a></div><div class="ttdeci">@ PM_SLEEP_LEAVE_TOP_HALF</div><div class="ttdef"><b>Definition:</b> pm.h:87</div></div>
<div class="ttc" id="agroup__PM_html_gga04e99c9c373636bd60b59f3f98d330eeacdb7fa2fb33997b7021e9d00faf5f593"><div class="ttname"><a href="group__PM.html#gga04e99c9c373636bd60b59f3f98d330eeacdb7fa2fb33997b7021e9d00faf5f593">PM_SLEEP_ENTRY</a></div><div class="ttdeci">@ PM_SLEEP_ENTRY</div><div class="ttdef"><b>Definition:</b> pm.h:81</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>When both sleep and GPIO input interrupts are enabled, the <a class="el" href="group__GPIO.html#gaab126e660e5024a5f0992c66cf4b1c4b">GPIO input interrupt</a> must be configured as <code>GPIO_TRIG_RISING_FAILING_EDGE</code>. Because the 2nd edge is used to trigger pm system to detect the sleep state. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
